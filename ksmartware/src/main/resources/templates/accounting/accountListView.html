<!DOCTYPE html>
<html class="no-js" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout/main">
	
	<th:block layout:fragment="customHead">
		<meta charset="UTF-8">
		<title>Sample</title>
		<th:block th:include="layout/customHead"></th:block>
		<script>
			$(document).ready(function(){				
				
				$('#hide').click(function(){
					$('#accountAddList').hide();
				});
				$('#show').click(function(){
					$('#accountAddList').show();
				});
				
				// account 리스트 버튼 클릭 이벤트
				let currentPage;
    			let lastPage;
				const firstPage = 1;
				$('#accountListButton').click(function(){
					console.log('계정과목 리스트버튼 테스트');
					
					$.ajax({
			    		url : '/getAccount'
			    		,type : 'get'
			    		,data : {'currentPage':currentPage}						
			    		,success:function(data){			    			
							$('#accountList').empty();							
							$(data.accountList).each(function(index,item){
								$('#accountList').append('<tr>');
								$('#accountList').append('<td>'+item.accountName+'</td>');
								$('#accountList').append('<td>'+item.accountDate+'</td>');
								$('#accountList').append('<td>'+item.memberId+'</td>');						
								$('#accountList').append('</tr>');
							});				
							console.log(data.accountList);
							console.log(data.selectCount);
							console.log(data.lastPage);
							console.log(data.currentPage);
							
							currentPage = data.currentPage;
							lastPage = data.lastPage;
							
							$('.paging').empty();
							if(currentPage > firstPage){
								$('.paging').append('<button type="button" id="beforePage">이전</button>');
							}
							if(currentPage < lastPage){
								$('.paging').append('<button type="button" id="nextPage">다음</button>');
							}
							$('#beforePage').click(function(){
								console.log('#beforePage click !!!');
								currentPage--;
								$('#accountListButton').trigger('click');
							});
							$('#nextPage').click(function(){
								console.log('#nextPage click !!!');
								currentPage++;
								$('#accountListButton').trigger('click');
							});							
						}
    				});					
				});
				
				//account add 버튼
				$('#accountAddButton').click(function(){				
					let accountName = $('#accountName').val();	            		
					console.log('계정과목 insert 테스트');
            		let memberId = $('#memberId').val();
	            		
            		$.ajax({
	               		url : '/addAccount'
	               		,type : 'post'
	               		,data : {'accountName':accountName,'memberId':memberId}   	
	               		,success : function(){
	               			$('#accountListButton').trigger('click');
	               			console.log('#accountAddButton click');
       					}                 
					});	
				});
				
				//$('#accountListButton').trigger('click');
				$('#hide').trigger('click');
				
				//memberId 리스트 조회
				
				$('#memberId').click(function(){
					console.log('memberId 클릭 테스트');
					$.ajax({
	               		url : '/getMemberId'
	               		,type : 'get'
	               		,success : function(data){
	               			console.log(data);
	               			$('#memberId').empty();
	               			$(data).each(function(index,item){
	               				$('#memberId').append('<option value="'+item.memberId+'">'+item.memberId+'</option>');
	               			});
       					}                 
					});	
				});
			});				
		</script>
	</th:block>
	
	<th:block layout:fragment="customBody">				
		<div class="card" style="min-height: 550px;">
			<div class="card-header d-block">
				<h3>계정과목</h3>					
					<table class="table table-hover" id="accountAddList">
						<thead>
							<tr>								
								<th>accountName</th>								
								<th>memberId</th>
								<th>add</th>	
								<th>list</th>									
							</tr>
						</thead>
				        <tbody>
							<tr>
								<td><input type="text" id="accountName"></td>								
								<td>
									<select id="memberId"></select>
								</td>				                
				                <td><button type="button" id="accountAddButton">add</button></td>								
								<td><button type="button" id="accountListButton">List</button></td>
							</tr>
						</tbody>
					</table>
					<button id="hide">Hide</button>
					<button id="show">Show</button>					
			</div>
			<div class="card-body p-0 table-border-style">
				<div class="table-responsive">
					<table class="table table-hover">
						<thead>
							<tr>
								<th>accountName</th>								
								<th>accountDate</th>
								<th>memberId</th>								
							</tr>
						</thead>
						<tbody id="accountList">
							<!-- <tr th:each="accountList:${accountList}">				
								<td th:text="${accountList.accountName}"></td>				
								<td th:text="${accountList.accountDate}"></td>
								<td th:text="${accountList.memberId}"></td>
								<td><button type="button" id="accountModifyButton">Modify</button></td>
								<td><button type="button" id="accountDeleteButton">Delete</button></td>				
							</tr> -->												
						</tbody>						
					</table>
					<div class="paging">
    	
   					</div>				
				</div>
			</div>
		</div>		
	</th:block>
	
	<th:block layout:fragment="customJquery">
		<th:block th:include="layout/customJquery"></th:block>
	</th:block>
	
</html>
